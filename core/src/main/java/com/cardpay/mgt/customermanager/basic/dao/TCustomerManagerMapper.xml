<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cardpay.mgt.customermanager.basic.dao.TCustomerManagerMapper">
  <resultMap id="BaseResultMap" type="com.cardpay.mgt.customermanager.basic.model.TCustomerManager">
    <result column="ID" jdbcType="DECIMAL" property="id" />
    <result column="LEVEL_ID" jdbcType="DECIMAL" property="levelId" />
    <result column="ORGANIZATION_ID" jdbcType="DECIMAL" property="organizationId" />
    <result column="USER_ID" jdbcType="DECIMAL" property="userId" />
    <result column="STATUS" jdbcType="DECIMAL" property="status" />
  </resultMap>

  <resultMap id="BaseVoMap" type="com.cardpay.mgt.customermanager.basic.model.vo.TCustomerManagerBaseVo">
    <result column="ID" jdbcType="DECIMAL" property="managerId" />
    <result column="LEVEL_ID" jdbcType="DECIMAL" property="levelId" />
    <result column="LEVEL_NAME" jdbcType="DECIMAL" property="levelName" />
    <result column="ORGANIZATION_ID" jdbcType="DECIMAL" property="organizationId" />
    <result column="ORG_NAME" jdbcType="DECIMAL" property="orgName" />
    <result column="STATUS" jdbcType="DECIMAL" property="status" />
    <association property="user" select="selectUser" column="USER_ID"/>
  </resultMap>

  <!--查询用户-->
  <select id="selectUser" resultType="com.cardpay.mgt.user.model.User">
    SELECT * FROM T_USER WHERE id = #{userId}
  </select>

  <!--查询客户经理BaseVo列表-->
  <select id="selectBaseVoList" resultMap="BaseVoMap">
    SELECT CM.*,CML.LEVEL_NAME,ORG.ORG_NAME
      FROM T_CUSTOMER_MANAGER CM,T_CUSTOMER_MANAGER_LEVEL CML,T_ORGANIZATION ORG
    WHERE
          CM.LEVEL_ID = CML.ID
      AND ORG.ID = CM.ORGANIZATION_ID
      AND CM.STATUS = #{status,jdbcType=DECIMAL}
    <if test="organizationId != null">
      AND ORGANIZATION_ID = #{organizationId,jdbcType=DECIMAL}
    </if>
    <if test="cName != null">
      AND CM.C_NAME LIKE #{cName,jdbcType=VARCHAR}
    </if>
    <if test="levelName != null">
      AND CML.LEVEL_NAME = #{levelName,jdbcType=VARCHAR}
    </if>
    <if test="id != null">
      AND CM.ID = #{id,jdbcType=DECIMAL}
    </if>
  </select>

  <!--根据UserID查询客户经理BaseVo-->
  <select id="selectBaseVoByUserId" resultMap="BaseVoMap">
    SELECT CM.*,CML.LEVEL_NAME,ORG.ORG_NAME
      FROM T_CUSTOMER_MANAGER CM,T_CUSTOMER_MANAGER_LEVEL CML,T_ORGANIZATION ORG
    WHERE
          CM.LEVEL_ID = CML.ID
      AND ORG.ID = CM.ORGANIZATION_ID
      AND CM.USER_ID = #{userId,jdbcType=DECIMAL}
  </select>
</mapper>